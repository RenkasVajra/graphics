# Лабораторная работа 6: Типовые двумерные и трехмерные объекты в OpenGL

## Описание

Программа демонстрирует работу с компьютерной графикой в OpenGL через библиотеку Pygame. Реализованы функции для отрисовки типовых двумерных и трехмерных объектов согласно требованиям задания. Поддерживается два режима рисования: линии и полигоны, а также интерактивное управление сценой.

## Основные функции

### Двумерные объекты

#### `draw_square(center_x, center_y, size, color, mode)`
**Назначение:** Рисует квадрат с центром в заданной точке.

**Параметры:**
- `center_x, center_y` (float) - координаты центра квадрата
- `size` (float) - размер стороны квадрата
- `color` (tuple) - цвет в формате RGB (0.0-1.0)
- `mode` - режим рисования (GL_LINE_LOOP или GL_QUADS)

#### `draw_quadrilateral(center_x, center_y, width, height, color, mode)`
**Назначение:** Рисует четырехугольник (прямоугольник).

**Параметры:**
- `center_x, center_y` (float) - координаты центра
- `width, height` (float) - ширина и высота
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_circle(center_x, center_y, radius, segments, color, mode)`
**Назначение:** Рисует круг путем апроксимации многоугольником.

**Параметры:**
- `center_x, center_y` (float) - координаты центра
- `radius` (float) - радиус круга
- `segments` (int) - количество сегментов для апроксимации
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_polygon(center_x, center_y, radius, sides, color, mode)`
**Назначение:** Рисует правильный многоугольник.

**Параметры:**
- `center_x, center_y` (float) - координаты центра
- `radius` (float) - радиус описанной окружности
- `sides` (int) - количество сторон
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

### Прямоугольные трехмерные объекты

#### `draw_parallelepiped(center_x, center_y, center_z, lx, ly, lz, color, mode)`
**Назначение:** Рисует параллелепипед (обобщенный куб).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра
- `lx, ly, lz` (float) - размеры по осям X, Y, Z
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_pyramid(center_x, center_y, center_z, base_size, height, color, mode)`
**Назначение:** Рисует пирамиду с квадратным основанием.

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра основания
- `base_size` (float) - размер стороны основания
- `height` (float) - высота пирамиды
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_trapezoid(center_x, center_y, center_z, top_width, bottom_width, depth, height, color, mode)`
**Назначение:** Рисует трапецию (усеченную пирамиду).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра
- `top_width, bottom_width` (float) - ширина верхнего и нижнего оснований
- `depth` (float) - глубина (размер по оси Z)
- `height` (float) - высота
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_tetrahedron(center_x, center_y, center_z, size, color, mode)`
**Назначение:** Рисует тетраэдр (правильный четырехгранник).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра
- `size` (float) - размер тетраэдра
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

### Круглые трехмерные объекты

#### `draw_polygonal_pyramid(center_x, center_y, center_z, base_radius, height, sides, color, mode)`
**Назначение:** Рисует пирамиду с многоугольным основанием.

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра основания
- `base_radius` (float) - радиус основания
- `height` (float) - высота пирамиды
- `sides` (int) - количество сторон основания
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_cone(center_x, center_y, center_z, base_radius, height, segments, color, mode)`
**Назначение:** Рисует конус.

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра основания
- `base_radius` (float) - радиус основания
- `height` (float) - высота конуса
- `segments` (int) - количество сегментов для апроксимации
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_cylinder(center_x, center_y, center_z, bottom_radius, top_radius, height, segments, color, mode)`
**Назначение:** Рисует цилиндр (общий случай с разными радиусами оснований).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра
- `bottom_radius, top_radius` (float) - радиусы нижнего и верхнего оснований
- `height` (float) - высота цилиндра
- `segments` (int) - количество сегментов для апроксимации
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### Функции апроксимации сферы

**`draw_sphere_lines(center_x, center_y, center_z, radius, segments, color)`**
- Аппроксимация сферы линиями (меридианы и параллели)

**`draw_sphere_triangles(center_x, center_y, center_z, radius, segments, color)`**
- Аппроксимация сферы треугольниками

**`draw_sphere_pentagons(center_x, center_y, center_z, radius, color)`**
- Аппроксимация сферы пятиугольниками (на основе икосаэдра)

#### `draw_3d_spiral(center_x, center_y, center_z, radius, height, turns, segments, color, mode)`
**Назначение:** Рисует трехмерную спираль (типа пружины).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты начала спирали
- `radius` (float) - радиус спирали
- `height` (float) - высота спирали
- `turns` (int) - количество витков
- `segments` (int) - количество сегментов
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

#### `draw_torus(center_x, center_y, center_z, major_radius, minor_radius, major_segments, minor_segments, color, mode)`
**Назначение:** Рисует тор (бублик).

**Параметры:**
- `center_x, center_y, center_z` (float) - координаты центра
- `major_radius` (float) - большой радиус (расстояние от центра до центра трубки)
- `minor_radius` (float) - малый радиус (радиус трубки)
- `major_segments, minor_segments` (int) - количество сегментов
- `color` (tuple) - цвет в формате RGB
- `mode` - режим рисования

### Правильные многогранники

#### `draw_hexahedron(center_x, center_y, center_z, size, color, mode)`
**Назначение:** Рисует гексаэдр (куб).

#### `draw_octahedron(center_x, center_y, center_z, size, color, mode)`
**Назначение:** Рисует октаэдр.

#### `draw_icosahedron(center_x, center_y, center_z, size, color, mode)`
**Назначение:** Рисует икосаэдр (20-гранник).

#### `draw_dodecahedron(center_x, center_y, center_z, size, color, mode)`
**Назначение:** Рисует додекаэдр (12-гранник).

### `draw_axis()`
**Назначение:** Рисует координатные оси для ориентации в пространстве.

**Цвета осей:**
- **Красная (X)** - от (0,0,0) до (1,0,0)
- **Зеленая (Y)** - от (0,0,0) до (0,1,0)
- **Синяя (Z)** - от (0,0,0) до (0,0,1)

**Использование:** Помогает визуально определить ориентацию объектов в пространстве.

### `draw_cube(lx, ly, lz)`
**Назначение:** Рисует куб с заданными размерами.

**Параметры:**
- `lx` (float) - длина по оси X
- `ly` (float) - длина по оси Y
- `lz` (float) - длина по оси Z

**Реализация:**
- Определяет 8 вершин куба
- Соединяет вершины 12 ребрами
- Использует `GL_LINES` для отрисовки каркаса
- Цвет: белый (1, 1, 1)

**Геометрия:**
- Вершины вычисляются относительно центра куба
- Каждая грань представлена 4 ребрами

### `draw_spiral(radius, height, turns, segments)`
**Назначение:** Рисует трехмерную спираль.

**Параметры:**
- `radius` (float) - радиус спирали
- `height` (float) - высота спирали
- `turns` (int) - количество витков
- `segments` (int) - количество сегментов для аппроксимации

**Алгоритм:**
1. Для каждого сегмента вычисляет:
   - Угол: `angle = i / segments * turns * 2 * π`
   - X координата: `x = radius * cos(angle)`
   - Y координата: `y = radius * sin(angle)`
   - Z координата: `z = height * i / segments`
2. Соединяет точки линией (`GL_LINE_STRIP`)

**Цвет:** Пурпурный (1, 0, 1)

### `draw_dodecahedron(size)`
**Назначение:** Рисует додекаэдр (правильный многогранник с 12 гранями).

**Параметры:**
- `size` (float) - масштаб додекаэдра

**Математические основы:**
- Использует золотое сечение: `φ = (1 + √5) / 2`
- Вершины вычисляются на основе математической модели додекаэдра
- 20 вершин, 12 пятиугольных граней

**Реализация:**
- Определяет 20 вершин додекаэдра
- Соединяет вершины в 12 пятиугольных граней
- Использует `GL_POLYGON` для заливки граней
- Цвет: серый (0.5, 0.5, 0.5)

**Геометрия:**
- Вершины масштабируются параметром `size`
- Каждая грань - правильный пятиугольник

## Обработка событий

### Управление мышью
**Функционал:**
- **Зажатие левой кнопки мыши** - активирует режим вращения сцены
- **Перемещение мыши** - вращает всю сцену:
  - Вертикальное движение - вращение вокруг оси X
  - Горизонтальное движение - вращение вокруг оси Y
- **Скорость вращения:** `rotation_speed = 0.1`

### Переключение режимов рисования
**Клавиша:** `ПРОБЕЛ (SPACE)`
- Переключает между режимами: линии ↔ полигоны
- Текущий режим отображается в заголовке окна

### Изменение размера окна
**Событие:** `VIDEORESIZE`
- Автоматически обновляет viewport
- Пересчитывает перспективную проекцию

## Структура программы

### Инициализация
- Создание окна Pygame 1200x800
- Настройка OpenGL контекста
- Установка перспективной проекции (45°)
- Включение теста глубины (`GL_DEPTH_TEST`)
- Инициализация переменных для анимации

### Основной цикл
1. Обработка событий (закрытие, мышь, клавиатура, изменение размера)
2. Очистка буферов цвета и глубины
3. Установка камеры и проекции
4. Применение глобального вращения сцены
5. Отрисовка всех объектов с анимацией:
   - **2D объекты:** квадрат, четырехугольник, круг, шестиугольник
   - **Прямоугольные 3D:** параллелепипед, пирамида, трапеция, тетраэдр
   - **Круглые 3D:** многоугольная пирамида, конус, цилиндр, сфера, спираль, тор
   - **Правильные многогранники:** гексаэдр, октаэдр, икосаэдр, додекаэдр
6. Обновление заголовка окна с информацией о режиме
7. Обновление экрана

## Как запустить

1. Установите зависимости:
   ```bash
   pip install pygame PyOpenGL numpy
   ```
2. Запустите программу:
   ```bash
   python lab6.py
   ```

## Зависимости

- `pygame` - библиотека для создания окон и обработки событий
- `OpenGL.GL` - основные функции OpenGL для рисования
- `OpenGL.GLU` - утилиты OpenGL (gluPerspective, матричные операции)
- `numpy` - для математических вычислений
- `math` - встроенные математические функции (sin, cos, sqrt)

## Системные требования

- Python 3.6+
- Графическая карта с поддержкой OpenGL
- Операционная система: Windows/Linux/macOS

## Технические характеристики

- **Разрешение окна:** 1200x800 пикселей
- **Угол обзора камеры:** 45°
- **Ближняя плоскость отсечения:** 0.1
- **Дальняя плоскость отсечения:** 50.0
- **Тест глубины:** Включен (GL_DEPTH_TEST)

## Управление

- **Левая кнопка мыши + движение** - вращение всей сцены
- **Пробел** - переключение между режимами рисования (линии ↔ полигоны)
- **Закрытие окна** - выход из программы
- **Изменение размера окна** - автоматическая адаптация

## Особенности реализации

### Режимы рисования
Программа поддерживает два режима визуализации:
- **Линии (GL_LINE_LOOP):** Отображает каркас объектов
- **Полигоны (GL_QUADS/GL_POLYGON/GL_TRIANGLES):** Закрашенные поверхности

### Анимация
- Некоторые объекты вращаются автоматически для демонстрации
- Анимация использует счетчик кадров для плавного движения
- Разные объекты имеют разные скорости вращения

### Организация объектов
Все функции рисования имеют унифицированный интерфейс:
```python
def draw_object(center_x, center_y, center_z, ... , color, mode)
```

### Геометрические объекты

#### Двумерные примитивы
- **Квадрат:** Простая форма с равными сторонами
- **Четырехугольник:** Прямоугольник с заданными размерами
- **Круг:** Аппроксимация окружности многоугольником
- **Многоугольник:** Правильные многоугольники с любым количеством сторон

#### Прямоугольные тела
- **Параллелепипед:** Обобщенный куб с разными размерами по осям
- **Пирамида:** Четырехгранная пирамида с квадратным основанием
- **Трапеция:** Усеченная пирамида с трапециевидными основаниями
- **Тетраэдр:** Правильный четырехгранник

#### Круглые тела
- **Многоугольная пирамида:** Пирамида с правильным многоугольником в основании
- **Конус:** Коническая поверхность с круговым основанием
- **Цилиндр:** Общий случай с возможными разными радиусами оснований
- **Сфера:** Три способа апроксимации (линии, треугольники, пятиугольники)
- **Трехмерная спираль:** Винтообразная кривая в пространстве
- **Тор:** Поверхность вращения типа "бублик"

#### Правильные многогранники
- **Гексаэдр (куб):** 6 граней
- **Октаэдр:** 8 граней
- **Икосаэдр:** 20 граней
- **Додекаэдр:** 12 граней

## Расположение объектов в сцене

Объекты организованы в четыре ряда:

1. **Верхний ряд (2D объекты):** Квадрат, четырехугольник, круг, шестиугольник
2. **Правый верхний (прямоугольные 3D):** Параллелепипед, пирамида, трапеция, тетраэдр
3. **Правый нижний (круглые 3D):** 6 различных объектов от пирамиды до тора
4. **Левый столбец (правильные многогранники):** Гексаэдр, октаэдр, икосаэдр, додекаэдр

## Математические основы

### Параметрические уравнения

#### Трехмерная спираль
```
x(t) = center_x + radius * cos(2π * turns * t)
y(t) = center_y + height * t
z(t) = center_z + radius * sin(2π * turns * t)
```
где `t ∈ [0, 1]`

#### Тор (тороидальная поверхность)
```
x(u,v) = center_x + (major_radius + minor_radius * cos(v)) * cos(u)
y(u,v) = center_y + minor_radius * sin(v)
z(u,v) = center_z + (major_radius + minor_radius * cos(v)) * sin(u)
```
где `u ∈ [0, 2π]`, `v ∈ [0, 2π]`

#### Сфера (параметрические уравнения)
```
x(θ,φ) = center_x + radius * sin(θ) * cos(φ)
y(θ,φ) = center_y + radius * sin(θ) * sin(φ)
z(θ,φ) = center_z + radius * cos(θ)
```
где `θ ∈ [0, π]` (широта), `φ ∈ [0, 2π]` (долгота)

### Правильные многогранники

#### Золотое сечение
Используется в додекаэдре и икосаэдре:
```
φ = (1 + √5) / 2 ≈ 1.6180339887
```

#### Координаты вершин додекаэдра
```
(±1, ±1, ±1), (0, ±φ, ±1/φ), (±1/φ, 0, ±φ), (±φ, ±1/φ, 0)
```

#### Координаты вершин икосаэдра
```
(0, ±1, ±φ), (±1, ±φ, 0), (±φ, 0, ±1)
```

### Алгоритмы апроксимации

#### Сфера линиями
- Меридианы: фиксированный φ, изменяемый θ
- Параллели: фиксированный θ, изменяемый φ

#### Сфера треугольниками
- Разбиение на сферические треугольники
- Использование широтных поясов и долготных линий

#### Сфера пятиугольниками
- Использование икосаэдра как основы
- Каждая грань икосаэдра апроксимирует часть сферы

